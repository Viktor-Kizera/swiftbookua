---
title: –ú–∞–∫—Ä–æ—Å–∏
layout: default
parent: –ü–æ—Å—ñ–±–Ω–∏–∫ –∑ –º–æ–≤–∏
nav_order: 19
has_children: false
has_toc: false
---

# –ú–∞–∫—Ä–æ—Å–∏

‚ö†Ô∏èüõ†Ô∏è –£–≤–∞–≥–∞! –¶–µ–π –ø—ñ–¥—Ä–æ–∑–¥—ñ–ª –Ω–∞—Ä–∞–∑—ñ –ø–µ—Ä–µ–∫–ª–∞–¥–∞—î—Ç—å—Å—è, —Ç–æ–º—É –Ω–∞—Ä–∞–∑—ñ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ –≤–∞—à—ñ–π —É–≤–∞–∑—ñ –Ω–µ–ø–æ–≤—Ç–æ—Ä–Ω–∏–π –æ—Ä–∏–≥—ñ–Ω–∞–ª üõ†Ô∏è‚ö†Ô∏è

–ú–∞–∫—Ä–æ—Å–∏ –≥–µ–Ω–µ—Ä—É—é—Ç—å –∫–æ–¥ –ø—ñ–¥ —á–∞—Å –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó.

–ú–∞–∫—Ä–æ—Å–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É—é—Ç—å –≤–∞—à –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ –ø—Ä–∏ –π–æ–≥–æ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó, —â–æ –¥–æ–∑–≤–æ–ª—è—î —É–Ω–∏–∫–Ω—É—Ç–∏ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–æ–≥–æ –∫–æ–¥—É –≤—Ä—É—á–Ω—É. –ü—ñ–¥ —á–∞—Å –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó, Swift —Ä–æ–∑–≥–æ—Ä—Ç–∞—î –∫–æ–∂–µ–Ω –º–∞–∫—Ä–æ—Å —É –≤–∞—à–æ–º—É –∫–æ–¥—ñ –ø–µ—Ä–µ–¥ –∑–≤–∏—á–∞–π–Ω–æ—é –∫–æ–º–ø—ñ–ª—è—Ü—ñ—î—é –≤–∞—à–æ–≥–æ –∫–æ–¥—É.

![–î—ñ–∞–≥—Ä–∞–º–∞, —â–æ –∑–æ–±—Ä–∞–∂–∞—î —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É. –ó–ª—ñ–≤–∞ ‚Äì —Å—Ç–∏–ª—ñ–∑–æ–≤–∞–Ω–∞ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—è –∫–æ–¥—É Swift. –°–ø—Ä–∞–≤–∞ ‚Äì —Ü–µ–π –∂–µ –∫–æ–¥ –∑ –∫—ñ–ª—å–∫–æ–º–∞ —Ä—è–¥–∫–∞–º–∏, —è–∫—ñ –¥–æ–¥–∞–ª–∏—Å—å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–∞–∫—Ä–æ—Å—É.](../../assets/macro-expansion@2x.png)

–†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É —î –∑–∞–≤–∂–¥–∏ –∞–¥–∏—Ç–∏–≤–Ω–æ—é –æ–ø–µ—Ä–∞—Ü—ñ—î—é: –º–∞–∫—Ä–æ—Å–∏ –¥–æ–¥–∞—é—Ç—å –Ω–æ–≤–∏–π –∫–æ–¥, –∞–ª–µ –≤–æ–Ω–∏ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –≤–∏–¥–∞–ª—è—é—Ç—å —ñ –Ω–µ –∑–º—ñ–Ω—é—é—Ç—å –≤–∂–µ –Ω–∞—è–≤–Ω–∏–π –∫–æ–¥.

–Ø–∫ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –º–∞–∫—Ä–æ—Å—É, —Ç–∞–∫ —ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å—Å—è, —â–æ–± –≥–∞—Ä–∞–Ω—Ç—É–≤–∞—Ç–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω—É –ø—Ä–∞–≤–∏–ª—å–Ω—ñ—Å—Ç—å —Ü—å–æ–≥–æ –∫–æ–¥—É –Ω–∞ Swift. –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç—å—Å—è –∫–æ—Ä–µ–∫—Ç–Ω—ñ—Å—Ç—å —Ç–∏–ø—ñ–≤ –∑–Ω–∞—á–µ–Ω—å, —â–æ –≤–∏ –ø–µ—Ä–µ–¥–∞—î—Ç–µ –¥–æ –º–∞–∫—Ä–æ—Å—É, —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è —É –∫–æ–¥—ñ, –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ–º—É –º–∞–∫—Ä–æ—Å–æ–º. –ù–∞ –¥–æ–¥–∞—á—É, —è–∫—â–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–∫—Ä–æ—Å—É –ø—ñ–¥ —á–∞—Å —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É —Å—Ç–∏–∫–∞—î—Ç—å—Å—è –∑ –ø–æ–º–∏–ª–∫–æ—é, –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –≤–≤–∞–∂–∞—î —Ü–µ –ø–æ–º–∏–ª–∫–æ—é –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó. –¶—ñ –≥–∞—Ä–∞–Ω—Ç—ñ—ó –¥–æ–∑–≤–æ–ª—è—é—Ç—å –ª–µ–≥—à–µ —Ä–æ–∑–º—ñ—Ä–∫–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ –∫–æ–¥, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–∞–∫—Ä–æ—Å–∏, –∞ —Ç–∞–∫–æ–∂ –¥–æ–∑–≤–æ–ª—è—é—Ç—å –ª–µ–≥—à–µ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –ø—Ä–æ–±–ª–µ–º–∏ –Ω–∞ –∫—à—Ç–∞–ª—Ç –Ω–µ–∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É, —á–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–∞–∫—Ä–æ—Å—É, —â–æ –º—ñ—Å—Ç–∏—Ç—å –±–∞–≥. 

–£ Swift —î –¥–≤–∞ –≤–∏–¥–∏ –º–∞–∫—Ä–æ—Å—ñ–≤:
 - *–û–∫—Ä–µ–º–æ —Å—Ç–æ—è—á–∏–π –º–∞–∫—Ä–æ—Å* –∑'—è–≤–ª—è—î—Ç—å—Å—è –≤ –∫–æ–¥—ñ —Å–∞–º–æ—Å—Ç—ñ–π–Ω–æ, –±–µ–∑ –ø—Ä–∏–≤'—è–∑–∫–∏ –¥–æ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è.
 - *–ü—Ä–∏–≤'—è–∑–∞–Ω–∏–π –º–∞–∫—Ä–æ—Å* –∑–º—ñ–Ω—é—î –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è, –¥–æ —è–∫–æ–≥–æ –≤—ñ–Ω –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π.

–ü—Ä–∏–≤'—è–∑–∞–Ω—ñ —Ç–∞ –æ–∫—Ä–µ–º–æ —Å—Ç–æ—è—á—ñ –º–∞–∫—Ä–æ—Å–∏ –≤–∏–∫–ª–∏–∫–∞—é—Ç—å—Å—è –¥–µ—â–æ –ø–æ-—Ä—ñ–∑–Ω–æ–º—É, –∞–ª–µ –æ–±–∏–¥–≤–∞ —Ü—ñ –≤–∏–¥–∏ –º–∞–∫—Ä–æ—Å—ñ–≤ —Å–ª—ñ–¥—É—é—Ç—å –æ–¥–Ω—ñ–π —ñ —Ç—ñ–π –∂–µ –º–æ–¥–µ–ª—ñ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—ñ–≤, —ñ —ó—Ö —Ä–µ–∞–ª—ñ–∑–æ–≤—É—é—Ç—å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –æ–¥–Ω–æ–≥–æ —ñ —Ç–æ–≥–æ –∂ –ø—ñ–¥—Ö–æ–¥—É. –ù–∞—Å—Ç—É–ø–Ω—ñ —Ä–æ–∑–¥—ñ–ª–∏ –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å—É—é—Ç—å –∫–æ–∂–µ–Ω –≤–∏–¥ –º–∞–∫—Ä–æ—Å—ñ–≤.

## –û–∫—Ä–µ–º–æ —Å—Ç–æ—è—á—ñ –º–∞–∫—Ä–æ—Å–∏

–©–æ–± –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –æ–∫—Ä–µ–º–æ —Å—Ç–æ—è—á–∏–π –º–∞–∫—Ä–æ—Å, —Å–ª—ñ–¥ –Ω–∞–ø–∏—Å–∞—Ç–∏ –∑–Ω–∞–∫ —Ä–µ—à—ñ—Ç–∫–∏ (`#`) –ø–µ—Ä–µ–¥ –π–æ–≥–æ –Ω–∞–∑–≤–æ—é, —ñ —Å–ª—ñ–¥ —Ç–∞–∫–æ–∂ –≤–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ –π–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∏, —è–∫—â–æ –≤–æ–Ω–∏ —î, —É –¥—É–∂–∫–∞—Ö –ø—ñ—Å–ª—è –π–æ–≥–æ –Ω–∞–∑–≤–∏. –ù–∞–ø—Ä–∏–∫–ª–∞–¥:

```swift
func myFunction() {
    print("–ù–∞—Ä–∞–∑—ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è \(#function)")
    #warning("–©–æ—Å—å –Ω–µ —Ç–∞–∫")
}
```

–£ –ø–µ—Ä—à–æ–º—É —Ä—è–¥–∫—É, –∑–∞–ø–∏—Å `#function` –≤–∏–∫–ª–∏–∫–∞—î –º–∞–∫—Ä–æ—Å [`function`][] –∑—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Swift. –ü—ñ–¥ —á–∞—Å –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó —Ü—å–æ–≥–æ –∫–æ–¥—É, Swift –≤–∏–∫–ª–∏–∫–∞—î —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é —Ü—å–æ–≥–æ –º–∞–∫—Ä–æ—Å—É, –∫–æ—Ç—Ä–∞ –∑–∞–º—ñ–Ω—é—î –≤–∏—Ä–∞–∑ `#function` –Ω–∞–∑–≤–æ—é –ø–æ—Ç–æ—á–Ω–æ—ó —Ñ—É–Ω–∫—Ü—ñ—ó. –Ø–∫—â–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ —Ü–µ–π –∫–æ–¥ —Ç–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é `myFunction()`, –≤–æ–Ω–∞ –Ω–∞–¥—Ä—É–∫—É—î "–ù–∞—Ä–∞–∑—ñ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è myFunction()". –ù–∞ –¥—Ä—É–≥–æ–º—É —Ä—è–¥–∫—É, –≤–∏—Ä–∞–∑ `#warning` –≤–∏–∫–ª–∏–∫–∞—î –º–∞–∫—Ä–æ—Å [`warning(_:)`][] –∑—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Swift, —â–æ —Å—Ç–≤–æ—Ä—é—î –≤–∞—à–µ –≤–ª–∞—Å–Ω–µ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞.

[`function`]: https://developer.apple.com/documentation/swift/function
[`warning(_:)`]: https://developer.apple.com/documentation/swift/warning(_:)

–û–∫—Ä–µ–º–æ —Å—Ç–æ—è—á—ñ –º–∞–∫—Ä–æ—Å–∏ –º–æ–∂—É—Ç—å —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è, —è–∫ —Ä–æ–±–∏—Ç—å –º–∞–∫—Ä–æ—Å `#function`, –∞–±–æ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –¥—ñ—é –ø—ñ–¥ —á–∞—Å –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó, —è–∫ —Ä–æ–±–∏—Ç—å –º–∞–∫—Ä–æ—Å `#warning`.

## –ü—Ä–∏–≤'—è–∑–∞–Ω—ñ –º–∞–∫—Ä–æ—Å–∏

–©–æ–± –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π –º–∞–∫—Ä–æ—Å, —Å–ª—ñ–¥ –Ω–∞–ø–∏—Å–∞—Ç–∏ –∑–Ω–∞–∫ (`@`) –ø–µ—Ä–µ–¥ –π–æ–≥–æ –Ω–∞–∑–≤–æ—é, —Ç–∞ –≤–∫–∞–∑–∞—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç–∏ –º–∞–∫—Ä–æ—Å–∞, —è–∫—â–æ –≤–æ–Ω–∏ —î, —É –¥—É–∂–∫–∞—Ö –ø—ñ—Å–ª—è –π–æ–≥–æ –Ω–∞–∑–≤–∏. 

–ü—Ä–∏–≤'—è–∑–∞–Ω—ñ –º–∞–∫—Ä–æ—Å–∏ –∑–º—ñ–Ω—é—é—Ç—å –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è, –¥–æ —è–∫–æ–≥–æ –≤–æ–Ω–∏ –ø—Ä–∏–≤'—è–∑–∞–Ω—ñ. –í–æ–Ω–∏ –¥–æ–¥–∞—é—Ç—å –∫–æ–¥ –¥–æ —Ü—å–æ–≥–æ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è, –Ω–∞ –∫—à—Ç–∞–ª—Ç –¥–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –º–µ—Ç–æ–¥—É –∞–±–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø—ñ–¥–ø–æ—Ä—è–¥–∫—É–≤–∞–Ω–Ω—è –¥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É. 

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∫–æ–¥, —â–æ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–∞–∫—Ä–æ—Å—ñ–≤:

```swift
struct SundaeToppings: OptionSet {
    let rawValue: Int
    static let nuts = SundaeToppings(rawValue: 1 << 0)
    static let cherry = SundaeToppings(rawValue: 1 << 1)
    static let fudge = SundaeToppings(rawValue: 1 << 2)
}
```

–£ —Ü—å–æ–º—É –∫–æ–¥—ñ, –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –∫–æ–∂–Ω–æ—ó –æ–ø—Ü—ñ—ó —ñ–∑ –º–Ω–æ–∂–∏–Ω–∏ –æ–ø—Ü—ñ–π `SundaeToppings` –º—ñ—Å—Ç–∏—Ç—å –≤–∏–∫–ª–∏–∫ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ç–æ—Ä–∞, –∫–æ—Ç—Ä–∏–π —î –ø–æ–≤—Ç–æ—Ä—é–≤–∞–Ω–∏–º –∫–æ–¥–æ–º, –Ω–∞–ø–∏—Å–∞–Ω–∏–º –≤—Ä—É—á–Ω—É. –£ —Ç–∞–∫–æ–º—É –∫–æ–¥—ñ –ª–µ–≥–∫–æ –∑—Ä–æ–±–∏—Ç–∏ –ø–æ–º–∏–ª–∫—É –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –Ω–æ–≤–æ—ó –æ–ø—Ü—ñ—ó, –Ω–∞–±—Ä–∞–≤—à–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–µ —á–∏—Å–ª–æ –Ω–∞–ø—Ä–∏–∫—ñ–Ω—Ü—ñ —Ä—è–¥–∫–∞. 

–û—Å—å –≤–µ—Ä—Å—ñ—è —Ü—å–æ–≥–æ –∫–æ–¥—É, —â–æ –Ω–∞—Ç–æ–º—ñ—Å—Ç—å –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–∞–∫—Ä–æ—Å:

```swift
@OptionSet<Int>
struct SundaeToppings {
    private enum Options: Int {
        case nuts
        case cherry
        case fudge
    }
}
```

–¶—è –≤–µ—Ä—Å—ñ—è `SundaeToppings` –≤–∏–∫–ª–∏–∫–∞—î –º–∞–∫—Ä–æ—Å [`@OptionSet`][] –∑—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Swift. –¶–µ–π –º–∞–∫—Ä–æ—Å –≤–∏—á–∏—Ç—É—î —Å–ø–∏—Å–æ–∫ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—è, –≥–µ–Ω–µ—Ä—É—î —Å–ø–∏—Å–æ–∫ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –¥–ª—è –∫–æ–∂–Ω–æ—ó –æ–ø—Ü—ñ—ó, —Ç–∞ –¥–æ–¥–∞—î –ø—ñ–¥–ø–æ—Ä—è–¥–∫—É–≤–∞–Ω–Ω—è –¥–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É [`OptionSet`][].

[`@OptionSet`]: https://developer.apple.com/documentation/swift/optionset-swift.macro
[`OptionSet`]: https://developer.apple.com/documentation/swift/optionset-swift.protocol

–î–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è, –æ—Å—å —è–∫ –≤–∏–≥–ª—è–¥–∞—î —Ü–µ–π –∫–æ–¥ –ø—ñ—Å–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É `@OptionSet`. –í–∞–º –Ω–µ –¥–æ–≤–µ–¥–µ—Ç—å—Å—è –ø–∏—Å–∞—Ç–∏ —Ç–∞–∫–∏–π –∫–æ–¥, —ñ –≤–∏ –π–æ–≥–æ –ø–æ–±–∞—á–∏—Ç–µ –ª–∏—à–µ —è–∫—â–æ –≤–∏ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –ø–æ–ø—Ä–æ—Å–∏—Ç–µ Swift –ø–æ–∫–∞–∑–∞—Ç–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É. 

```swift
struct SundaeToppings {
    private enum Options: Int {
        case nuts
        case cherry
        case fudge
    }

    typealias RawValue = Int
    var rawValue: RawValue
    init() { self.rawValue = 0 }
    init(rawValue: RawValue) { self.rawValue = rawValue }
    static let nuts: Self = Self(rawValue: 1 << Options.nuts.rawValue)
    static let cherry: Self = Self(rawValue: 1 << Options.cherry.rawValue)
    static let fudge: Self = Self(rawValue: 1 << Options.fudge.rawValue)
}
extension SundaeToppings: OptionSet { }
```

–í–µ—Å—å –∫–æ–¥ –ø—ñ—Å–ª—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—è –∑'—è–≤–ª—è—î—Ç—å—Å—è –∑ –º–∞–∫—Ä–æ—Å—É `@OptionSet`. –í–µ—Ä—Å—ñ—è `SundaeToppings`, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–∞–∫—Ä–æ—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –≤—Å—ñ—Ö —Å—Ç–∞—Ç–∏—á–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö, —î –ø—Ä–æ—Å—Ç—ñ—à–æ—é –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è —Ç–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏, –∞–Ω—ñ–∂ –ø–æ–ø–µ—Ä–µ–¥–Ω—è –≤–µ—Ä—Å—ñ—è, –æ–≥–æ–ª–æ—à–µ–Ω–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤—Ä—É—á–Ω—É. 

## –û–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—ñ–≤

–£ –±—ñ–ª—å—à–æ—Å—Ç—ñ –∫–æ–¥—É Swift, —è–∫—â–æ –≤–∞–º —Ç—Ä–µ–±–∞ –æ–≥–æ–ª–æ—Å–∏—Ç–∏ —Å–∏–º–≤–æ–ª, —Ç–∞–∫–∏–π —è–∫ —Ñ—É–Ω–∫—Ü—ñ—é —á–∏ —Ç–∏–ø, –≤–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–µ –æ–∫—Ä–µ–º–µ –π–æ–≥–æ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è. –û–¥–Ω–∞–∫, –¥–ª—è –º–∞–∫—Ä–æ—Å—ñ–≤, –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è —Ç–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —î —Ä–æ–∑–¥—ñ–ª–µ–Ω–∏–º–∏. –û–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É –º—ñ—Å—Ç–∏—Ç—å –π–æ–≥–æ –Ω–∞–∑–≤—É, –ø–∞—Ä–∞–º–µ—Ç—Ä–∏, —â–æ –≤—ñ–Ω –ø—Ä–∏–π–º–∞—î, –º—ñ—Å—Ü–µ, –¥–µ –π–æ–≥–æ –º–æ–∂–Ω–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏, —Ç–∞ —è–∫–æ–≥–æ –≤–∏–¥—É –∫–æ–¥ –≤—ñ–Ω –≥–µ–Ω–µ—Ä—É—î. –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–∫—Ä–æ—Å—É –º—ñ—Å—Ç–∏—Ç—å –∫–æ–¥, —â–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞—î –º–∞–∫—Ä–æ—Å, –≥–µ–Ω–µ—Ä—É—é—á–∏ –∫–æ–¥ –º–æ–≤–æ—é Swift.

–û–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É –≤–≤–æ–¥–∏—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª—é—á–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞ `macro`. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –æ—Å—å —á–∞—Å—Ç–∏–Ω–∞ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É `@OptionSet`, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è —É –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ: 

```swift
public macro OptionSet<RawType>() =
        #externalMacro(module: "SwiftMacros", type: "OptionSetMacro")
```

–ü–µ—Ä—à–∏–π —Ä—è–¥–æ–∫ –≤–∏–∑–Ω–∞—á–∞—î –Ω–∞–∑–≤—É –º–∞–∫—Ä–æ—Å—É —Ç–∞ –π–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∏: –Ω–∞–∑–≤–æ—é —î `OptionSet`, —ñ –≤—ñ–Ω –Ω–µ –ø—Ä–∏–π–º–∞—î –∂–æ–¥–Ω–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤. –î—Ä—É–≥–∏–π —Ä—è–¥–æ–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–∞–∫—Ä–æ—Å [`externalMacro(module:type:)`][] –∑—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Swift, —ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –π–æ–≥–æ –≤–∫–∞–∑—É—î Swift, –¥–µ –±—É–¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏—Å—å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —Ü—å–æ–≥–æ –º–∞–∫—Ä–æ—Å—É. –£ —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É, –º–æ–¥—É–ª—å `SwiftMacros` –º—ñ—Å—Ç–∏—Ç—å —Ç–∏–ø –Ω–∞ —ñ–º'—è `OptionSetMacro`, —â–æ —Ä–µ–∞–ª—ñ–∑–æ–≤—É—î –º–∞–∫—Ä–æ—Å `@OptionSet`.

[`externalMacro(module:type:)`]: https://developer.apple.com/documentation/swift/externalmacro(module:type:)

–û—Å–∫—ñ–ª—å–∫–∏ –º–∞–∫—Ä–æ—Å `OptionSet` —î –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–º, –π–æ–≥–æ –Ω–∞–∑–≤–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î [–í–µ—Ä—Ö–Ω—ñ–π–í–µ—Ä–±–ª—é–¥—è—á–∏–π–†–µ–≥—ñ—Å—Ç—Ä][], —Ç–∞–∫ —Å–∞–º–æ —è–∫ –Ω–∞–∑–≤–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä —Ç–∞ –∫–ª–∞—Å—ñ–≤. –û–∫—Ä–µ–º–æ —Å—Ç–æ—è—á—ñ –º–∞–∫—Ä–æ—Å–∏ –º–∞—é—Ç—å –Ω–∏–∂–Ω—ñ–π–í–µ—Ä–±–ª—é–¥—è—á–∏–π–†–µ–≥—ñ—Å—Ç—Ä, —è–∫ –Ω–∞–∑–≤–∏ –∑–º—ñ–Ω–Ω–∏—Ö —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–π.

[–í–µ—Ä—Ö–Ω—ñ–π–í–µ—Ä–±–ª—é–¥—è—á–∏–π–†–µ–≥—ñ—Å—Ç—Ä]: https://uk.wikipedia.org/wiki/–í–µ—Ä–±–ª—é–¥—è—á–∏–π_—Ä–µ–≥—ñ—Å—Ç—Ä

> **–ü—Ä–∏–º—ñ—Ç–∫–∞**:
>
> –ú–∞–∫—Ä–æ—Å–∏ –∑–∞–≤–∂–¥–∏ –æ–≥–æ–ª–æ—à—É—é—Ç—å—Å—è –ø—É–±–ª—ñ—á–Ω–∏–º–∏ (`public`). –û—Å–∫—ñ–ª—å–∫–∏ –∫–æ–¥, —â–æ –æ–≥–æ–ª–æ—à—É—î –º–∞–∫—Ä–æ—Å, —Ç–∞ –∫–æ–¥, —â–æ –π–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î, –∑–Ω–∞—Ö–æ–¥—è—Ç—å—Å—è —É —Ä—ñ–∑–Ω–∏—Ö –º–æ–¥—É–ª—è—Ö, –Ω–µ–ø—É–±–ª—ñ—á–Ω—ñ –º–∞–∫—Ä–æ—Å–∏ –Ω–µ–º–æ–∂–ª–∏–≤–æ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –±—É–¥—å-–¥–µ.

–û–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É –≤–∏–∑–Ω–∞—á–∞—î –π–æ–≥–æ *—Ä–æ–ª—å* ‚Äì –º—ñ—Å—Ü—è —É –≤–∏—Ö—ñ–¥–Ω–æ–º—É –∫–æ–¥—ñ, –≤ —è–∫–∏—Ö –º–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ü–µ–π –º–∞–∫—Ä–æ—Å, —ñ —Ä—ñ–∑–Ω–æ–≤–∏–¥–∏ –∫–æ–¥—É, —â–æ –º–æ–∂–µ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ü–µ–π –º–∞–∫—Ä–æ—Å. –ö–æ–∂–µ–Ω –º–∞–∫—Ä–æ—Å –º–∞—î –æ–¥–Ω—É –∞–±–æ –¥–µ–∫—ñ–ª—å–∫–∞ —Ä–æ–ª–µ–π, —è–∫—ñ –∑–∞–ø–∏—Å—É—é—Ç—å—Å—è —è–∫ —á–∞—Å—Ç–∏–Ω–∞ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ –Ω–∞ –ø–æ—á–∞—Ç–∫—É –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É. –û—Å—å —â–µ —Ç—Ä–æ—à–∫–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É `@OptionSet`, –≤–∫–ª—é—á–Ω–æ –∑ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏, —â–æ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –π–æ–≥–æ —Ä–æ–ª—ñ:

```swift
@attached(member)
@attached(conformance)
public macro OptionSet<RawType>() =
        #externalMacro(module: "SwiftMacros", type: "OptionSetMacro")
```

–ê—Ç—Ä–∏–±—É—Ç `@attached` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É —Ü—å–æ–º—É –æ–≥–æ–ª–æ—à–µ–Ω–Ω—ñ –¥–≤—ñ—á—ñ, –ø–æ –æ–¥–Ω–æ–º—É —Ä–∞–∑—É –Ω–∞ –∫–æ–∂–Ω—É —Ä–æ–ª—å –º–∞–∫—Ä–æ—Å—É. –£ –ø–µ—Ä—à–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ, `@attached(member)` –≤–∫–∞–∑—É—î, —â–æ –º–∞–∫—Ä–æ—Å –¥–æ–¥–∞—î –Ω–æ–≤—ñ —á–ª–µ–Ω–∏ –¥–æ —Ç–∏–ø—É, –Ω–∞ —è–∫–æ–º—É –π–æ–≥–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å. –ú–∞–∫—Ä–æ—Å `@OptionSet` –¥–æ–¥–∞—î —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ç–æ—Ä `init(rawValue:)`, –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —è–∫–æ–≥–æ –≤–∏–º–∞–≥–∞—î—Ç—å—Å—è –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º `OptionSet`, —Ç–∞–∫ —Å–∞–º–æ —è–∫ —ñ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —á–ª–µ–Ω–∏. –î—Ä—É–≥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è ‚Äì `@attached(conformance)` ‚Äì –≤–∫–∞–∑—É—î, —â–æ `@OptionSet` –¥–æ–¥–∞—î –æ–¥–Ω–µ –∞–±–æ –¥–µ–∫—ñ–ª—å–∫–∞ –ø—ñ–¥–ø–æ—Ä—è–¥–∫—É–≤–∞–Ω—å –ø—Ä–æ—Ç–æ–∫–æ–ª—É. –ú–∞–∫—Ä–æ—Å `@OptionSet` —Ä–æ–∑—à–∏—Ä—é—î —Ç–∏–ø, –¥–æ —è–∫–æ–≥–æ –≤—ñ–Ω –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è, –¥–æ–¥–∞—é—á–∏ –¥–æ –Ω—å–æ–≥–æ –ø—ñ–¥–ø–æ—Ä—è–¥–∫—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ç–æ–∫–æ–ª—É `OptionSet`.

–î–ª—è –æ–∫—Ä–µ–º–æ —Å—Ç–æ—è—á–æ–≥–æ –º–∞–∫—Ä–æ—Å—É, —Å–ª—ñ–¥ –ø–∏—Å–∞—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç `@freestanding`, —â–æ–± –≤–∫–∞–∑–∞—Ç–∏ –π–æ–≥–æ —Ä–æ–ª—å:

```swift
@freestanding(expression)
public macro line<T: ExpressibleByIntegerLiteral>() -> T =
        /* ... –º—ñ—Å—Ü–µ–∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–∞–∫—Ä–æ—Å–∞... */
```

–ú–∞–∫—Ä–æ—Å `#line` –≤–∏—â–µ –º–∞—î —Ä–æ–ª—å `expression`, —Ç–æ–±—Ç–æ –≤—ñ–Ω —î –≤–∏—Ä–∞–∑–æ–º. –ú–∞–∫—Ä–æ—Å–∏-–≤–∏—Ä–∞–∑–∏ –ø—Ä–æ–¥—É–∫—É—é—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è, –∞–±–æ –≤–∏–∫–æ–Ω—É—é—Ç—å –¥—ñ—ó —á–∞—Å—É –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó, –Ω–∞ –∫—à—Ç–∞–ª—Ç –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è. 

–ù–∞ –¥–æ–¥–∞—á—É –¥–æ —Ä–æ–ª—ñ –º–∞–∫—Ä–æ—Å—É, –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É –Ω–∞–¥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –Ω–∞–∑–≤–∏ —Å–∏–º–≤–æ–ª—ñ–≤, –∫–æ—Ç—Ä—ñ –≥–µ–Ω–µ—Ä—É—î –º–∞–∫—Ä–æ—Å. –ö–æ–ª–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É –º–∞—î —Å–ø–∏—Å–æ–∫ —ñ–º–µ–Ω, –≥–∞—Ä–∞–Ω—Ç—É—î—Ç—å—Å—è, —â–æ –≤—ñ–Ω —Å—Ç–≤–æ—Ä–∏—Ç—å –ª–∏—à–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ü—ñ —ñ–º–µ–Ω–∞. –¶–µ –¥–æ–ø–æ–º–∞–≥–∞—î –∑—Ä–æ–∑—É–º—ñ—Ç–∏ —Ç–∞ –∑–Ω–µ–≤–∞–¥–∏—Ç–∏ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –∫–æ–¥. –û—Å—å –ø–æ–≤–Ω–µ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É `@OptionSet`:

```swift
@attached(member, names: named(RawValue), named(rawValue), 
        named(`init`), arbitrary)
@attached(conformance)
public macro OptionSet<RawType>() =
        #externalMacro(module: "SwiftMacros", type: "OptionSetMacro")
```

–£ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—ñ –≤–∏—â–µ, –∞—Ç—Ä–∏–±—É—Ç `@attached(member)` –≤–∫–ª—é—á–∞—î –∞—Ä–≥—É–º–µ–Ω—Ç–∏ –ø—ñ—Å–ª—è –º—ñ—Ç–∫–∏ `named:` –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª—É, —â–æ –≥–µ–Ω–µ—Ä—É—î –º–∞–∫—Ä–æ—Å `@OptionSet`. –ú–∞–∫—Ä–æ—Å –¥–æ–¥–∞—î –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –¥–ª—è —Å–∏–º–≤–æ–ª—ñ–≤ –∑ –Ω–∞–∑–≤–∞–º–∏ `RawValue`, `rawValue`, —Ç–∞ `init`: –æ—Å–∫—ñ–ª—å–∫–∏ —Ü—ñ —ñ–º–µ–Ω–∞ —î –≤—ñ–¥–æ–º–∏–º–∏ –Ω–∞–ø–µ—Ä–µ–¥, –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É –ø–µ—Ä–µ—á–∏—Å–ª—é—î —ó—Ö —è–≤–Ω–æ.

–û–≥–æ–ª–æ—à–µ–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É —Ç–∞–∫–æ–∂ –≤–∫–ª—é—á–∞—î `arbitrary` –ø—ñ—Å–ª—è —Å–ø–∏—Å–∫—É –Ω–∞–∑–≤, —â–æ –¥–æ–∑–≤–æ–ª—è—î –º–∞–∫—Ä–æ—Å—É –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è, —á–∏—ó –Ω–∞–∑–≤–∏ —î –Ω–µ–≤—ñ–¥–æ–º–∏–º–∏ –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–ª–∏ –º–∞–∫—Ä–æ—Å `@OptionSet` –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ `SundaeToppings` –≤–∏—â–µ, –≤—ñ–Ω –≥–µ–Ω–µ—Ä—É—î –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ —Ç–∏–ø—É, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –µ–ª–µ–º–µ–Ω—Ç–∞–º –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—è `nuts`, `cherry`, —Ç–∞ `fudge`.

–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ –∑—ñ —Å–ø–∏—Å–∫–æ–º —Ä–æ–ª–µ–π –º–∞–∫—Ä–æ—Å—É –º–æ–∂–Ω–∞ –æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å —É —Å–µ–∫—Ü—ñ—è—Ö [attached]({% link _book/2_language_reference/07_attributes.md %}#attached) —Ç–∞ [freestanding]({% link _book/2_language_reference/07_attributes.md %}#freestanding) —Ä–æ–∑–¥—ñ–ª—É [–ê—Ç—Ä–∏–±—É—Ç–∏]({% link _book/2_language_reference/07_attributes.md %}).

## –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—ñ–≤

–ö–æ–ª–∏ Swift –∑–±–∏—Ä–∞—î –∫–æ–¥, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –º–∞–∫—Ä–æ—Å–∏, –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –≤–∏–∫–ª–∏–∫–∞—î —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é –º–∞–∫—Ä–æ—Å—É –¥–ª—è –π–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è.

![–î—ñ–∞–≥—Ä–∞–º–∞ —ñ–ª—é—Å—Ä—É—î —á–æ—Ç–∏—Ä–∏ –∫—Ä–æ–∫–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—ñ–≤.  –í—Ö–æ–¥–æ–º —î –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ Swift.  –í—ñ–Ω —Å—Ç–∞—î –¥–µ—Ä–µ–≤–æ–º, —â–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–¥—É.  –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–∫—Ä–æ—Å—É –¥–æ–¥–∞—î –≥—ñ–ª–∫–∏ –¥–æ –¥–µ—Ä–µ–≤–∞.  –†–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —î –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ Swift.](../../assets/macro-expansion-full@2x.png)

–ó–æ–∫—Ä–µ–º–∞, Swift —Ä–æ–∑–≥–æ—Ä—Ç–∞—î –º–∞–∫—Ä–æ—Å –Ω–∞—Å—Ç—É–ø–Ω–∏–º —Å–ø–æ—Å–æ–±–æ–º:

1. –ö–æ–º–ø—ñ–ª—è—Ç–æ—Ä —á–∏—Ç–∞—î –∫–æ–¥, —Å—Ç–≤–æ—Ä—é—é—á–∏ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—é —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É —É –ø–∞–º'—è—Ç—ñ. 
2. –ö–æ–º–ø—ñ–ª—è—Ç–æ—Ä –Ω–∞–¥—Å–∏–ª–∞—î —á–∞—Å—Ç–∏–Ω—É —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—ó —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É –¥–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–∞–∫—Ä–æ—Å—É, –∫–æ—Ç—Ä–∞ —Ä–æ–∑–≥–æ—Ä—Ç–∞—î –º–∞–∫—Ä–æ—Å. 
3. –ö–æ–º–ø—ñ–ª—è—Ç–æ—Ä –∑–∞–º—ñ–Ω—è—î –≤–∏–∫–ª–∏–∫ –º–∞–∫—Ä–æ—Å—É –π–æ–≥–æ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–æ—é —Ñ–æ—Ä–º–æ—é.
4. –ö–æ–º–ø—ñ–ª—è—Ç–æ—Ä –ø—Ä–æ–¥–æ–≤–∂—É—î –∑–±—ñ—Ä–∫—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏–π –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥.

–©–æ–± –ø—Ä–æ–π—Ç–∏—Å—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º–∏ –∫—Ä–æ–∫–∞–º–∏, —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –Ω–∞—Å—Ç—É–ø–Ω–µ:

```swift
let magicNumber = #fourCharacterCode("ABCD")
```

–ú–∞–∫—Ä–æ—Å `#fourCharacterCode` –ø—Ä–∏–π–º–∞—î —Ä—è–¥–æ–∫ –¥–æ–≤–∂–∏–Ω–æ—é —É —á–æ—Ç–∏—Ä–∏ —Å–∏–º–≤–æ–ª–∏ —Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î –±–µ–∑–∑–Ω–∞–∫–æ–≤–µ 32-–±—ñ—Ç–Ω–µ —Ü—ñ–ª–µ, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è–º ASCII —É —Ä—è–¥–∫—É, –ø–æ—î–¥–Ω–∞–Ω–∏—Ö —Ä–∞–∑–æ–º. –î–µ—è–∫—ñ —Ñ–∞–π–ª–æ–≤—ñ —Ñ–æ—Ä–º–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ü—ñ–ª—ñ —á–∏—Å–ª–∞ –Ω–∞ –∫—à—Ç–∞–ª—Ç —Ü—å–æ–≥–æ –¥–ª—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ —î –∫–æ–º–ø–∞–∫—Ç–Ω—ñ—à–∏–º–∏, –∞–ª–µ —ó—Ö –≤—Å–µ —â–µ –º–æ–∂–Ω–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —É –¥–µ–±–∞–≥–µ—Ä—ñ. –†–æ–∑–¥—ñ–ª [–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–∫—Ä–æ—Å—ñ–≤][] –Ω–∏–∂—á–µ –ø–æ—è—Å–Ω—é—î, —è–∫ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ü–µ–π –º–∞–∫—Ä–æ—Å. 

[–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–∫—Ä–æ—Å—ñ–≤]: {% link _book/1_language_guide/16_6_macros.md %}#–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è-–º–∞–∫—Ä–æ—Å—ñ–≤

–©–æ–± —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏ –º–∞–∫—Ä–æ—Å —É –∫–æ–¥—ñ –≤–∏—â–µ, –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä —á–∏—Ç–∞—î —Ñ–∞–π–ª Swift —Ç–∞ —Å—Ç–≤–æ—Ä—é—î —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—é —Ü—å–æ–≥–æ –∫–æ–¥—É —É –ø–∞–º'—è—Ç—ñ, –≤—ñ–¥–æ–º—É —è–∫ [–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω–µ –¥–µ—Ä–µ–≤–æ][], –∞–±–æ –ê–°–î. –ê–°–î —Ä–æ–±–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–¥—É —è–≤–Ω–æ—é, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–æ—Å—Ç—ñ—à–µ –ø–∏—Å–∞—Ç–∏ –∫–æ–¥, —â–æ –≤–∑–∞—î–º–æ–¥—ñ—î –∑ —Ü—ñ—î—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é ‚Äì –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–¥ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞ –∞–±–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–∞–∫—Ä–æ—Å—É. –û—Å—å —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—è –ê–°–î –¥–ª—è –∫–æ–¥—É –≤–∏—â–µ, —Ç—Ä–æ—à–∫–∏ —Å–ø—Ä–æ—â–µ–Ω–∞ –∑–∞ –∫–æ—à—Ç –æ–ø—É—Å–∫–∞–Ω–Ω—è –∑–∞–π–≤–∏—Ö –¥–µ—Ç–∞–ª–µ–π. 

[–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω–µ –¥–µ—Ä–µ–≤–æ]: https://uk.wikipedia.org/wiki/–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω–µ_—Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω–µ_–¥–µ—Ä–µ–≤–æ

![–î—ñ–∞–≥—Ä–∞–º–∞, —â–æ –∑–æ–±—Ä–∞–∂—É—î –¥–µ—Ä–µ–≤–æ, —ñ–∑ –∫–æ—Ä–µ–Ω–µ–≤–∏–º –µ–ª–µ–º–µ–Ω—Ç–æ–º constant.  –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –º–∞—î –Ω–∞–∑–≤—É magic number, —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è.  –ó–Ω–∞—á–µ–Ω–Ω—è–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏ —î –≤–∏–∫–ª–∏–∫ –º–∞–∫—Ä–æ—Å—É.  –í–∏–∫–ª–∏–∫ –º–∞–∫—Ä–æ—Å—É –º–∞—î –Ω–∞–∑–≤—É, fourCharacterCode, —Ç–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∏.  –Ñ–¥–∏–Ω–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º —î —Ä—è–¥–∫–æ–≤–∏–π –ª—ñ—Ç–µ—Ä–∞–ª, ABCD.](../../assets/macro-ast-original@2x.png)

–î—ñ–∞–≥—Ä–∞–º–∞ –≤–∏—â–µ —ñ–ª—é—Å—Ç—Ä—É—î, —è–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ü—å–æ–≥–æ –∫–æ–¥—É –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î—Ç—å—Å—è —É –ø–∞–º'—è—Ç—ñ. –ö–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç –ê–°–î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —á–∞—Å—Ç–∏–Ω—ñ –≤–∏—Ö—ñ–¥–Ω–æ–≥–æ –∫–æ–¥—É. –ï–ª–µ–º–µ–Ω—Ç –ê–°–î "Constant declaration" –º—ñ—Å—Ç–∏—Ç—å –¥–≤–∞ –¥–æ—á—ñ—Ä–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏, –∫–æ—Ç—Ä—ñ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç—É—é—Ç—å –¥–≤—ñ —á–∞—Å—Ç–∏–Ω–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏: —ó—ó –Ω–∞–∑–≤—É —Ç–∞ —ó—ó –∑–Ω–∞—á–µ–Ω–Ω—è. –ï–ª–µ–º–µ–Ω—Ç "Macro call" –º–∞—î –¥–≤–∞ –¥–æ—á—ñ—Ä–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏, —â–æ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç—É—é—Ç—å –Ω–∞–∑–≤—É –º–∞–∫—Ä–æ—Å—É —Ç–∞ —Å–ø–∏—Å–æ–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤, —â–æ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –¥–æ –º–∞–∫—Ä–æ—Å—É.

–£ —Ö–æ–¥—ñ –ø–æ–±—É–¥–æ–≤–∏ –ê–°–î, –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —â–æ –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ —î –∫–æ—Ä–µ–∫—Ç–Ω–∏–º –∫–æ–¥–æ–º –Ω–∞ Swift. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, `#fourCharacterCode` –ø—Ä–∏–π–º–∞—î —î–¥–∏–Ω–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç, —â–æ –º–∞—î –±—É—Ç–∏ —Ä—è–¥–∫–æ–º. –ü—Ä–∏ —Å–ø—Ä–æ–±—ñ –ø–µ—Ä–µ–¥–∞—Ç–∏ —Ü—ñ–ª–æ—á–∏—Å–µ–ª—å–Ω–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç, –∞–±–æ —è–∫—â–æ –∑–∞–±—É—Ç–∏ –ø–æ—Å—Ç–∞–≤–∏—Ç–∏ –ª–∞–ø–∫–∏ (`"`) –Ω–∞–ø—Ä–∏–∫—ñ–Ω—Ü—ñ —Ä—è–¥–∫–æ–≤–æ–≥–æ –ª—ñ—Ç–µ—Ä–∞–ª–∞, –º–∏ –æ—Ç—Ä–∏–º–∞—î–º–æ –ø–æ–º–∏–ª–∫—É –Ω–∞ —Ü—å–æ–º—É –µ—Ç–∞–ø—ñ –ø—Ä–æ—Ü–µ—Å—É –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó.

–ö–æ–º–ø—ñ–ª—è—Ç–æ—Ä –∑–Ω–∞—Ö–æ–¥–∏—Ç—å –º—ñ—Å—Ü—è —É –∫–æ–¥—ñ, –¥–µ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –º–∞–∫—Ä–æ—Å, —ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –∑–æ–≤–Ω—ñ—à–Ω—ñ–π –º–æ–¥—É–ª—å, —É —è–∫–æ–º—É —Ä–µ–∞–ª—ñ–∑–æ–≤—É—î—Ç—å—Å—è —Ü–µ–π –º–∞–∫—Ä–æ—Å. –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫—É –º–∞–∫—Ä–æ—Å—É, –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –ø–µ—Ä–µ–¥–∞—î —á–∞—Å—Ç–∏–Ω—É –ê–°–î –¥–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ü—å–æ–≥–æ –º–∞–∫—Ä–æ—Å—É. –û—Å—å —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—è —Ü—ñ—î—ó —á–∞—Å—Ç–∏–Ω–∏ –ê–°–î:

![–î—ñ–∞–≥—Ä–∞–º–∞, —â–æ –∑–æ–±—Ä–∞–∂—É—î –¥–µ—Ä–µ–≤–æ, —ñ–∑ –≤–∏–∫–ª–∏–∫–æ–º –º–∞–∫—Ä–æ—Å—É —è–∫ –∫–æ—Ä–µ–Ω–µ–≤–∏–π –µ–ª–µ–º–µ–Ω—Ç.  –í–∏–∫–ª–∏–∫ –º–∞–∫—Ä–æ—Å—É –º–∞—î –Ω–∞–∑–≤—É, fourCharacterCode, —Ç–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∏. –ê—Ä–≥—É–º–µ–Ω—Ç–æ–º —î —Ä—è–¥–∫–æ–≤–∏–π –ª—ñ—Ç–µ—Ä–∞–ª, ABCD](../../assets/macro-ast-input@2x.png)

–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–∫—Ä–æ—Å—É `#fourCharacterCode` –≤–∏—á–∏—Ç—É—î —Ü—é —á–∞—Å—Ç–∏–Ω—É –ê–°–î —è–∫ —Å–≤—ñ–π –≤—Ö—ñ–¥ –ø—Ä–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—ñ –º–∞–∫—Ä–æ—Å—É. –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–∫—Ä–æ—Å—É –æ–ø—Ä–∞—Ü—å–æ–≤—É—î –ª–∏—à–µ —á–∞—Å—Ç–∏–Ω—É –ê–°–î, –∫–æ—Ç—Ä—É –æ—Ç—Ä–∏–º—É—î –Ω–∞ –≤—Ö–æ–¥—ñ, —â–æ –æ–∑–Ω–∞—á–∞—î, —â–æ –º–∞–∫—Ä–æ—Å –∑–∞–≤–∂–¥–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è –≤ –æ–¥–∏–Ω —ñ —Ç–æ–π –∂–µ —Å–ø–æ—Å—ñ–± –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, —è–∫–∏–π –∫–æ–¥ –π–¥–µ –ø–µ—Ä–µ–¥ –Ω–∏–º –∞–±–æ –ø—ñ—Å–ª—è –Ω—å–æ–≥–æ. –¶–µ –æ–±–º–µ–∂–µ–Ω–Ω—è –¥–æ–ø–æ–º–∞–≥–∞—î –∑—Ä–æ–±–∏—Ç–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É –ª–µ–≥—à–∏–º –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è, —ñ –¥–æ–ø–æ–º–∞–≥–∞—î –≤–∞—à–æ–º—É –∫–æ–¥—É –∑–±–∏—Ä–∞—Ç–∏—Å—è —à–≤–∏–¥—à–µ, –æ—Å–∫—ñ–ª—å–∫–∏ Swift –º–æ–∂–µ —É–Ω–∏–∫–Ω—É—Ç–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É, –∫–æ—Ç—Ä–∏–π –Ω–µ –∑–º—ñ–Ω–∏–≤—Å—è. 

<!-- TODO TR: Confirm -->
Swift –¥–æ–ø–æ–º–∞–≥–∞—î –∞–≤—Ç–æ—Ä–∞–º –º–∞–∫—Ä–æ—Å—É —É–Ω–∏–∫–Ω—É—Ç–∏ –≤–∏–ø–∞–¥–∫–æ–≤–æ–≥–æ –≤–∏—á–∏—Ç—É–≤–∞–Ω–Ω—è —ñ–Ω—à–∏—Ö –≤—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö, –æ–±–º–µ–∂—É—é—á–∏ –∫–æ–¥, —â–æ —Ä–µ–∞–ª—ñ–∑–æ–≤—É—î –º–∞–∫—Ä–æ—Å. 

 - –ê–°–î, —â–æ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è –¥–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–∞–∫—Ä–æ—Å—É, –º—ñ—Å—Ç–∏—Ç—å –ª–∏—à–µ —Ç—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –ê–°–î, —â–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç—å –ª–∏—à–µ —Å–∞–º –º–∞–∫—Ä–æ—Å, –∞–ª–µ –Ω–µ —Å—Ç–æ—Å—É—é—Ç—å—Å—è –∂–æ–¥–Ω–æ–≥–æ –∫–æ–¥—É –ø–µ—Ä–µ–¥ –Ω–∏–º –∞–±–æ –ø—ñ—Å–ª—è –Ω—å–æ–≥–æ. 
 - –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–∫—Ä–æ—Å—É –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ –ø—ñ—Å–æ—á–Ω–∏—Ü—ñ, —â–æ –∑–∞–ø–æ–±—ñ–≥–∞—î –¥–æ—Å—Ç—É–ø—É –¥–æ —Ñ–∞–π–ª–æ–≤–æ—ó —Å–∏—Å—Ç–µ–º–∏ —Ç–∞ –º–µ—Ä–µ–∂—ñ. 

–ù–∞ –¥–æ–¥–∞—á—É –¥–æ —Ü–∏—Ö –º–µ—Ö–∞–Ω—ñ–∑–º—ñ–≤ –±–µ–∑–ø–µ–∫–∏, –∞–≤—Ç–æ—Ä –º–∞–∫—Ä–æ—Å—É —î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–∏–º –∑–∞ —Ç–µ, —â–æ–± –Ω–µ –≤–∏—á–∏—Ç—É–≤–∞—Ç–∏ –∞–±–æ –º–æ–¥–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏ –±—É–¥—å-—â–æ –∑–∞ –º–µ–∂–∞–º–∏ –≤—Ö–æ–¥—É –º–∞–∫—Ä–æ—Å—É. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É –Ω–µ –ø–æ–≤–∏–Ω–Ω–æ –∑–∞–ª–µ–∂–∞—Ç–∏ –≤—ñ–¥ –ø–æ—Ç–æ—á–Ω–æ–≥–æ —á–∞—Å—É –¥–æ–±–∏. 

–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–∫—Ä–æ—Å—É `#fourCharacterCode` –≥–µ–Ω–µ—Ä—É—î –Ω–æ–≤–µ –ê–°–î, –∫–æ—Ç—Ä–µ –º—ñ—Å—Ç–∏—Ç—å —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∏–π –∫–æ–¥. –û—Å—å —â–æ —Ü–µ–π –∫–æ–¥ –ø–æ–≤–µ—Ä—Ç–∞—î –¥–æ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–∞:

![–î—ñ–∞–≥—Ä–∞–º–∞, —â–æ –∑–æ–±—Ä–∞–∂–∞—î –¥–µ—Ä–µ–≤–æ –∑ —î–¥–∏–Ω–∏–º –µ–ª–µ–º–µ–Ω—Ç–æ–º, —â–æ —î —Ü—ñ–ª–æ—á–∏—Å–µ–ª—å–Ω–∏–º –ª—ñ—Ç–µ—Ä–∞–ª–æ–º 1145258561.](../../assets/macro-ast-output@2x.png)

–ö–æ–ª–∏ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –æ—Ç—Ä–∏–º—É—î —Ü–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è, –≤—ñ–Ω –∑–∞–º—ñ–Ω—è—î –µ–ª–µ–º–µ–Ω—Ç –ê–°–î, —â–æ –º—ñ—Å—Ç–∏—Ç—å –≤–∏–∫–ª–∏–∫ –º–∞–∫—Ä–æ—Å—É, –µ–ª–µ–º–µ–Ω—Ç–æ–º, —â–æ –º—ñ—Å—Ç–∏—Ç—å —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É. –ü—ñ—Å–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –º–∞–∫—Ä–æ—Å—É, –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä –∑–Ω–æ–≤—É –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∫–æ–¥ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —â–æ–± —É–ø–µ–≤–Ω–∏—Ç–∏—Å—å, —â–æ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤—Å–µ —â–µ —î —Å–∏–Ω—Ç–∞–∫—Å–∏—á–Ω–æ –∫–æ—Ä–µ–∫—Ç–Ω–∏–º –∫–æ–¥–æ–º –Ω–∞ Swift, —ñ —â–æ –≤—Å—ñ —Ç–∏–ø–∏ —î –∫–æ—Ä–µ–∫—Ç–Ω–∏–º–∏. –¶–µ –ø—Ä–æ–¥—É–∫—É—î —Ñ—ñ–Ω–∞–ª—å–Ω–µ –ê–°–î, —â–æ —Ç–µ–ø–µ—Ä –º–æ–∂–µ –±—É—Ç–∏ —Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–æ, —è–∫ –∑–∞–∑–≤–∏—á–∞–π:

![–î—ñ–∞–≥—Ä–∞–º–∞, —â–æ –∑–æ–±—Ä–∞–∂–∞—î –¥–µ—Ä–µ–≤–æ –∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ—é —É –∫–æ—Ä–µ–Ω—ñ.  –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –º–∞—î –Ω–∞–∑–≤—É magic number, —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è.  –ó–Ω–∞—á–µ–Ω–Ω—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏ —î —Ü—ñ–ª–æ—á–∏—Å–µ–ª—å–Ω–∏–º –ª—ñ—Ç–µ—Ä–∞–ª–æ–º –∑—ñ –∑–Ω–∞—á–µ–Ω–Ω—è–º 1145258561](../../assets/macro-ast-result@2x.png)

–¶–µ –ê–°–î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∫–æ–¥—É –Ω–∞ –∫—à—Ç–∞–ª—Ç —Ü—å–æ–≥–æ: 

```swift
let magicNumber = 1145258561
```

–£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ, –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ –Ω–∞ –ø–æ—á–∞—Ç–∫—É –º—ñ—Å—Ç–∏—Ç—å –ª–∏—à–µ –æ–¥–∏–Ω –º–∞–∫—Ä–æ—Å, –∞–ª–µ —É —Ä–µ–∞–ª—å–Ω—ñ–π –ø—Ä–æ–≥—Ä–∞–º—ñ –º–æ–∂–µ –±—É—Ç–∏ –¥–µ–∫—ñ–ª—å–∫–∞ –µ–∫–∑–µ–º–ø–ª—è—Ä—ñ–≤ –æ–¥–Ω–æ–≥–æ –º–∞–∫—Ä–æ—Å—É, —ñ –¥–µ–∫—ñ–ª—å–∫–∞ –≤–∏–∫–ª–∏–∫—ñ–≤ –¥–æ —Ä—ñ–∑–Ω–∏—Ö –º–∞–∫—Ä–æ—Å—ñ–≤. –ö–æ–º–ø—ñ–ª—è—Ç–æ—Ä —Ä–æ–∑–≥–æ—Ä—Ç–∞—î –º–∞–∫—Ä–æ—Å–∏ –ø–æ –æ–¥–Ω–æ–º—É –∑–∞ —Ä–∞–∑. 

–Ø–∫—â–æ –æ–¥–∏–Ω –º–∞–∫—Ä–æ—Å –∑'—è–≤–ª—è—î—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —ñ–Ω—à–æ–≥–æ, –∑–æ–≤–Ω—ñ—à–Ω—ñ–π –º–∞–∫—Ä–æ—Å —Ä–æ–∑–≥–æ—Ä–Ω–µ—Ç—å—Å—è –ø–µ—Ä—à–∏–º ‚Äì —Ü–µ –¥–æ–∑–≤–æ–ª—è—î –∑–æ–≤–Ω—ñ—à–Ω—å–æ–º—É –º–∞–∫—Ä–æ—Å—É –∑–º—ñ–Ω–∏—Ç–∏ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π –º–∞–∫—Ä–æ—Å –¥–æ —Ç–æ–≥–æ, —è–∫ –≤—ñ–Ω —Ä–æ–∑–≥–æ—Ä–Ω–µ—Ç—å—Å—è. 

<!-- OUTLINE

- TR: Is there any limit to nesting?
  TR: Is it valid to nest like this -- if so, anything to note about it?

  ```
  let something = #someMacro {
      struct A { }
      @someMacro struct B { }
  }
  ```

- Macro recursion is limited.
  One macro can call another,
  but a given macro can't directly or indirectly call itself.
  The result of macro expansion can include other macros,
  but it can't include a macro that uses this macro in its expansion
  or declare a new macro.
  (TR: Likely need to iterate on details here)
-->

## –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–∫—Ä–æ—Å—ñ–≤

To implement a macro, you make two components:
A type that performs the macro expansion,
and a library that declares the macro to expose it as API.
These parts are built separately from code that uses the macro,
even if you're developing the macro and its clients together,
because the macro implementation runs
as part of building the macro's clients.

To create a new macro using Swift Package Manager,
run `swift package init --type macro` ---
this creates several files,
including a template for a macro implementation and declaration.

To add macros to an existing project,
add a target for the macro implementation
and a target for the macro library.
For example,
you can add something like the following to your `Package.swift` file,
changing the names to match your project:

```swift
targets: [
    // Macro implementation that performs the source transformations.
    .macro(
        name: "MyProjectMacros",
        dependencies: [
            .product(name: "SwiftSyntaxMacros", package: "swift-syntax"),
            .product(name: "SwiftCompilerPlugin", package: "swift-syntax")
        ]
    ),

    // Library that exposes a macro as part of its API.
    .target(name: "MyProject", dependencies: ["MyProjectMacros"]),
]
```

The code above defines two targets:
`MyProjectMacros` contains the implementation of the macros,
and `MyProject` makes those macros available.

The implementation of a macro
uses the [SwiftSyntax][] module to interact with Swift code
in a structured way, using an AST.
If you created a new macro package with Swift Package Manager,
the generated `Package.swift` file
automatically includes a dependency on SwiftSyntax.
If you're adding macros to an existing project,
add a dependency on SwiftSyntax in your `Package.swift` file:

[SwiftSyntax]: http://github.com/apple/swift-syntax/

```swift
dependencies: [
    .package(url: "https://github.com/apple/swift-syntax.git", from: "some-tag"),
],
```

Replace the `some-tag` placeholder in the code above
with the Git tag for the version of SwiftSyntax you want to use.

Depending on your macro's role,
there's a corresponding protocol from SwiftSystem
that the macro implementation conforms to.
For example,
consider `#fourCharacterCode` from the previous section.
Here's a structure that implements that macro:

```swift
public struct FourCharacterCode: ExpressionMacro {
    public static func expansion(
        of node: some FreestandingMacroExpansionSyntax,
        in context: some MacroExpansionContext
    ) throws -> ExprSyntax {
        guard let argument = node.argumentList.first?.expression,
              let segments = argument.as(StringLiteralExprSyntax.self)?.segments,
              segments.count == 1,
              case .stringSegment(let literalSegment)? = segments.first
        else {
            throw CustomError.message("Need a static string")
        }

        let string = literalSegment.content.text
        guard let result = fourCharacterCode(for: string) else {
            throw CustomError.message("Invalid four-character code")
        }

        return "\(raw: result)"
    }
}

private func fourCharacterCode(for characters: String) -> UInt32? {
    guard characters.count == 4 else { return nil }

    var result: UInt32 = 0
    for character in characters {
        result = result << 8
        guard let asciiValue = character.asciiValue else { return nil }
        result += UInt32(asciiValue)
    }
    return result.bigEndian
}
enum CustomError: Error { case message(String) }
```

The `#fourCharacterCode` macro
is a freestanding macro that produces an expression,
so the `FourCharacterCode` type that implements it
conforms to the `ExpressionMacro` protocol.
The `ExpressionMacro` protocol has one requirement,
a `expansion(of:in:)` method that expands the AST.
For the list of macro roles and their corresponding SwiftSystem protocols,
see <doc:Attributes#attached> and <doc:Attributes#freestanding>
in <doc:Attributes>

To expand the `#fourCharacterCode` macro,
Swift sends the AST for the code that uses this macro
to the library that contains the macro implementation.
Inside the library, Swift calls `FourCharacterCode.expansion(of:in:)`,
passing in the AST and the context as arguments to the method.
The implementation of `expansion(of:in:)`
finds the string that was passed as an argument to `#fourCharacterCode`
and calculates the corresponding integer literal value.

In the example above,
the first `guard` block extracts the string literal from the AST,
assigning that AST element to `literalSegment`.
The second `guard` block
calls the private `FourCharacterCode(for:)` function.
Both of these blocks throw an error if the macro is used incorrectly ---
the error message becomes a compiler error
at the malformed call site.
For example,
if you try to call the macro as `#fourCharacterCode("AB" + "CD")`
the compiler shows the error "Need a static string".

The `expansion(of:in:)` method returns an instance of `ExprSyntax`,
a type from SwiftSyntax that represents an expression in an AST.
Because this type conforms to the `StringLiteralConvertible` protocol,
the macro implementation uses a string literal
as a lightweight syntax to create its result.
All of the SwiftSyntax types that you return from a macro implementation
conform to `StringLiteralConvertible`,
so you can use this approach when implementing any kind of macro.

<!-- TODO contrast the `\(raw:)` and non-raw version.  -->

<!--
The return-a-string APIs come from here

https://github.com/apple/swift-syntax/blob/main/Sources/SwiftSyntaxBuilder/Syntax%2BStringInterpolation.swift
-->


<!-- OUTLINE:

- Note:
  Behind the scenes, Swift serializes and deserializes the AST,
  to pass the data across process boundaries,
  but your macro implementation doesn't need to deal with any of that.

- This method is also passed a macro-expansion context, which you use to:

    + Generate unique symbol names
    + Produce diagnostics (`Diagnostic` and `SimpleDiagnosticMessage`)
    + Find a node's location in source

- Macro expansion happens in their surrounding context.
  A macro can affect that environment if it needs to ‚Äî
  and a macro that has bugs can interfere with that environment.
  (Give guidance on when you'd do this.  It should be rare.)

- Generated symbol names let a macro
  avoid accidentally interacting with symbols in that environment.
  To generate a unique symbol name,
  call the `MacroExpansionContext.makeUniqueName()` method.

- Ways to create a syntax node include
  Making an instance of the `Syntax` struct,
  or `SyntaxToken`
  or `ExprSyntax`.
  (Need to give folks some general ideas,
  and enough guidance so they can sort through
  all the various `SwiftSyntax` node types and find the right one.)

- Attached macros follow the same general model as expression macros,
  but with more moving parts.

- Pick the subprotocol of `AttachedMacro` to conform to,
  depending on which kind of attached macro you're making.
  [This is probably a table]

  + `AccessorMacro` goes with `@attached(accessor)`
  + `ConformanceMacro` goes with `@attached(conformance)`
    [missing from the list under Declaring a Macro]
  + `MemberMacro` goes with `@attached(member)`
  + `PeerMacro` goes with `@attached(peer)`
  + `MemberAttributeMacro` goes with `@member(memberAttribute)`

- Code example of conforming to `MemberMacro`.

  ```
  static func expansion<
    Declaration: DeclGroupSyntax,
    Context: MacroExpansionContext
  >(
    of node: AttributeSyntax,
    providingMembersOf declaration: Declaration,
    in context: Context
  ) throws -> [DeclSyntax]
  ```

- Adding a new member by making an instance of `Declaration`,
  and returning it as part of the `[DeclSyntax]` list.

-->

## Developing and Debugging Macros

Macros are well suited to development using tests:
They transform one AST into another AST
without depending on any external state,
and without making changes to any external state.
In addition, you can create syntax nodes from a string literal,
which simplifies setting up the input for a test.
You can also read the `description` property of an AST
to get a string to compare against an expected value.
For example,
here's a test of the `#fourCharacterCode` macro from previous sections:

```swift
let source: SourceFileSyntax =
    """
    let abcd = #fourCharacterCode("ABCD")
    """

let file = BasicMacroExpansionContext.KnownSourceFile(
    moduleName: "MyModule",
    fullFilePath: "test.swift"
)

let context = BasicMacroExpansionContext(sourceFiles: [source: file])

let transformedSF = source.expand(
    macros:["fourCharacterCode": FourCC.self],
    in: context
)

let expectedDescription =
    """
    let abcd = 1145258561
    """

precondition(transformedSF.description == expectedDescription)
```

The example above tests the macro using a precondition,
but you could use a testing framework instead.

<!-- OUTLINE:

- Ways to view the macro expansion while debugging.
  The SE prototype provides `-Xfrontend -dump-macro-expansions` for this.
  [TR: Is this flag what we should suggest folks use,
  or will there be better command-line options coming?]

- Use diagnostics for macros that have constraints/requirements
  so your code can give a meaningful error to users when those aren't met,
  instead of letting the compiler try & fail to build the generated code.

Additional APIs and concepts to introduce in the future,
in no particular order:

- Using `SyntaxRewriter` and the visitor pattern for modifying the AST

- Adding a suggested correction using `FixIt`

- concept of trivia

- `TokenSyntax`
-->

<!--
This source file is part of the Swift.org open source project

Copyright (c) 2014 - 2023 Apple Inc. and the Swift project authors
Licensed under Apache License v2.0 with Runtime Library Exception

See https://swift.org/LICENSE.txt for license information
See https://swift.org/CONTRIBUTORS.txt for the list of Swift project authors
-->
